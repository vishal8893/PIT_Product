<p-toast></p-toast>
<div class="row card shadow-sm bg-white px-3 mx-0 mb-3">

    <form autocomplete="off" [formGroup]="TreadForm">

        <div class="row">
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <p-dropdown [options]="AssetARrray" formControlName="Asset" optionLabel="Name" [filter]="true"
                        (onClear)="onAssetCleared1()" (onChange)="onchangeevent()" filterBy="Name" optionValue="Name"
                        [showClear]="true" placeholder="Select Asset" class="form-control px-0" required></p-dropdown>
                    <label for="inputText4" class="">Asset<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('Asset').hasError('required') && (TreadForm.get('Asset').touched || TreadForm.get('Asset').dirty)">
                        Asset Required.
                    </small>
                </div>
            </div>

            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <p-dropdown [options]="finalItems" formControlName="RequestID" optionLabel="Display"
                        (onClear)="onAssetCleared2()" (onChange)="setalldata($event)" [filter]="true" filterBy="ID"
                        placeholder="Request ID" [showClear]="true" optionValue="ID" class="form-control px-0"
                        required></p-dropdown>
                    <label for="inputText4" class="">Request ID<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('RequestID').hasError('required') && (TreadForm.get('RequestID').touched || TreadForm.get('RequestID').dirty)">
                        Request ID Required.
                    </small>
                </div>
            </div>

            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="text" class="form-control w-100" placeholder="" formControlName="AccountCode" readonly
                        pInputText>
                    <label for="inputText4" class="">Account Code<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('AccountCode').hasError('required') && (TreadForm.get('AccountCode').touched || TreadForm.get('AccountCode').dirty)">
                        Account Code Required.
                    </small>
                </div>
            </div>

            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="text" class="form-control w-100" placeholder="" formControlName="AccountName"
                        pInputText readonly>
                    <label for="inputText4" class="">Account Name<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('AccountName').hasError('required') && (TreadForm.get('AccountName').touched || TreadForm.get('AccountName').dirty)">
                        LOB Code Required.
                    </small>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="text" class="form-control w-100" placeholder="" formControlName="Mode" pInputText
                        readonly>
                    <label for="inputText4" class="">Mode<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('Mode').hasError('required') && (TreadForm.get('Mode').touched || TreadForm.get('Mode').dirty)">
                        Mode Required.
                    </small>
                </div>
            </div>
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="text" class="form-control w-100" placeholder="" formControlName="ScriptName" pInputText
                        readonly>
                    <label for="inputText4" class="">Script Name<span class="required-asterisk">*</span></label>
                    <span>ISIN : {{ISIN}}</span>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('ScriptName').hasError('required') && (TreadForm.get('ScriptName').touched || TreadForm.get('ScriptName').dirty)">
                        Script Name Required.
                    </small>
                </div>
            </div>
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="text" class="form-control w-100" placeholder="" formControlName="RequestedQuantity"
                        pInputText readonly>
                    <label for="inputText4" class="">Requested Quantity<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('RequestedQuantity').hasError('required') && (TreadForm.get('RequestedQuantity').touched || TreadForm.get('RequestedQuantity').dirty)">
                        Requested Quantity Required.
                    </small>
                </div>
            </div>
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="number" class="form-control w-100" placeholder="" formControlName="TotalPrice"
                        pInputText readonly>
                    <label for="inputText4" class="">Total Price<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('TotalPrice').hasError('required') && (TreadForm.get('TotalPrice').touched || TreadForm.get('TotalPrice').dirty)">
                        TotalPrice Required.
                    </small>
                </div>
            </div>

        </div>
        <div class="row">
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">

                    <p-calendar class="ui-timepicker ui-widget-header ui-corner-all ng-tns-c9-1 ng-star-inserted"
                        inputId="icon" formControlName="TradeDate" placeholder="Select Trade Date" [showIcon]="true"
                        class="border-0 form-control p-0 calendarIcon" styleClass="w-100" required></p-calendar>
                    <label class=" pt-0">Trade Date<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('TradeDate').hasError('required') && (TreadForm.get('TradeDate').touched || TreadForm.get('TradeDate').dirty)">
                        Trade Date Required.
                    </small>
                </div>
            </div>
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="text" class="form-control w-100" placeholder="" formControlName="Exchange" pInputText>
                    <label for="inputText4" class="">Exchange<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('Exchange').hasError('required') && (TreadForm.get('Exchange').touched || TreadForm.get('Exchange').dirty)">
                        Exchange Required.
                    </small>
                </div>
            </div>
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="number" class="form-control w-100" placeholder="" formControlName="TradeQty" pInputText
                        required #val (keyup)="setlotandQuantity(val)">
                    <label for="inputText4" class="">Trade Qty<span class="required-asterisk">*</span></label>
                    <samp>Trade Available Qty : {{TradeAvailableQty}}</samp>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('TradeQty').hasError('required') && (TreadForm.get('TradeQty').touched || TreadForm.get('TradeQty').dirty)">
                        TradeQty Required.
                    </small>
                </div>
            </div>
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="number" class="form-control w-100" placeholder="" formControlName="StrikePrice"
                        pInputText readonly>
                    <label for="inputText4" class="">Strike Price<span class="required-asterisk">*</span></label>

                    <small style="color: red;"
                        *ngIf="TreadForm.get('StrikePrice').hasError('required') && (TreadForm.get('StrikePrice').touched || TreadForm.get('StrikePrice').dirty)">
                        StrikePrice Required.
                    </small>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">

                    <p-calendar class="ui-timepicker ui-widget-header ui-corner-all ng-tns-c9-1 ng-star-inserted"
                        [showIcon]="true" inputId="icon" formControlName="ExpiryDate" placeholder="Select Trade Date"
                        class="border-0 form-control p-0 calendarIcon" styleClass="w-100" readonly></p-calendar>
                    <label class=" pt-0">Expiry Date<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('ExpiryDate').hasError('required') && (TreadForm.get('ExpiryDate').touched || TreadForm.get('ExpiryDate').dirty)">
                        Expiry Date Required.
                    </small>
                </div>
            </div>
            <div class="inputText col-md-4 col-lg-4 col-xl-3 mb-2">
                <div class="form-floating form-floating-outline">
                    <input type="number" class="form-control w-100" placeholder="" formControlName="OptionType"
                        pInputText readonly>
                    <label for="inputText4" class="">Option Type<span class="required-asterisk">*</span></label>
                    <small style="color: red;"
                        *ngIf="TreadForm.get('OptionType').hasError('required') && (TreadForm.get('OptionType').touched || TreadForm.get('OptionType').dirty)">
                        Option Type Required.
                    </small>
                </div>
            </div>
        </div>
    </form>

    <div class="col-12 text-center">
        <button pButton pRipple type="button" (click)="createBtn()" label="" [disabled]="TreadForm.invalid"
            class="btn-light btn-primary p-button-info p-button-sm mx-1 py-2">Add</button>


        <button pButton pRipple type="button" (click)="cancel()" label=""
            class="p-button-secondary button-sm mx-1 py-2">Cancel</button>

        <button pButton pRipple type="button" (click)="Closerecord()" label=""
            class="btn-light btn-primary p-button-info p-button-sm mx-1 py-2">Close Request</button>
    </div>

    <!-- <div class="col-12">
        <p-table #dt [value]="products" dataKey="id"
            styleClass="p-datatable-products p-datatable-sm p-datatable-gridlines" [rowHover]="true" [rows]="5"
            [showCurrentPageReport]="true" [rowsPerPageOptions]="[5,10,15,20]" [paginator]="true"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [filterDelay]="0"
            [globalFilterFields]="['Segment','ENTITY_NAME','AccName','Mode','ScripName','ISIN','TotalPrice','TradeDate','TradedQuantity','StrikePrice','ExpiryDate','OptionType']">
            <ng-template pTemplate="caption">
                <div class="table-header">
                    <span class="globalSearch p-input-icon-left">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                            class="p-inputtext-sm" placeholder="Global Search" />
                    </span>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="Segment">Segment<p-sortIcon field="Segment"></p-sortIcon></th>
                    <th pSortableColumn="ENTITY_NAME">Account Code<p-sortIcon field="country.name"></p-sortIcon></th>
                    <th pSortableColumn="AccName">Account Name<p-sortIcon field="AccName"></p-sortIcon></th>
                    <th pSortableColumn="Mode">Mode<p-sortIcon field="Mode"></p-sortIcon></th>
                    <th pSortableColumn="ScripName">Script Name<p-sortIcon field="ScripName"></p-sortIcon></th>
                    <th pSortableColumn="ISIN">ISIN No<p-sortIcon field="ISIN"></p-sortIcon></th>
                    <th pSortableColumn="TotalPrice">Total Price<p-sortIcon field="TotalPrice"></p-sortIcon></th>
                    <th pSortableColumn="TradeDate">Trade Date<p-sortIcon field="TradeDate"></p-sortIcon></th>
                    <th pSortableColumn="TradedQuantity">Trade QTY<p-sortIcon field="TradedQuantity"></p-sortIcon></th>
                    <th pSortableColumn="StrikePrice">Strike Price<p-sortIcon field="StrikePrice"></p-sortIcon></th>
                    <th pSortableColumn="ExpiryDate">Expiry Date<p-sortIcon field="ExpiryDate"></p-sortIcon></th>
                    <th pSortableColumn="OptionType">Option Type<p-sortIcon field="OptionType"></p-sortIcon></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-product>
                <tr class="p-selectable-row">
                    <td>

                        {{product.Segment}}
                    </td>
                    <td>

                        <span class="image-text">{{product.AccCode
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.AccName
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.Mode
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.ScripName
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.ISIN
                            }}</span>
                    </td>

                    <td>

                        <span class="image-text">{{product.TotalPrice
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.TradeDate | date:'yyyy-MM-dd'
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.TradedQuantity
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.StrikePrice
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.ExpiryDate | date:'yyyy-MM-dd'
                            }}</span>
                    </td>
                    <td>

                        <span class="image-text">{{product.OptionType
                            }}</span>
                    </td>

                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="8">No products found.</td>
                </tr>
            </ng-template>
        </p-table>
    </div> -->
    <div class="col-12">
  <p-table
    #dt
    [value]="products"
    dataKey="id"
    styleClass="p-datatable-products p-datatable-sm p-datatable-gridlines"
    [rowHover]="true"
    [rows]="5"
    [paginator]="true"
    [rowsPerPageOptions]="[5, 10, 15, 20]"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [filterDelay]="0"
    [globalFilterFields]="[
      'Segment',
      'AccCode',
      'AccName',
      'Mode',
      'ScripName',
      'ISIN',
      'TotalPrice',
      'TradeDate',
      'TradedQuantity',
      'StrikePrice',
      'ExpiryDate',
      'OptionType'
    ]"
  >
    <!-- Global Search -->
    <ng-template pTemplate="caption">
      <div class="table-header">
        <span class="globalSearch p-input-icon-left">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="text"
            (input)="dt.filterGlobal($event.target.value, 'contains')"
            class="p-inputtext-sm"
            placeholder="Global Search"
          />
        </span>
      </div>
    </ng-template>

    <!-- Table Header -->
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="Segment">Segment <p-sortIcon field="Segment"></p-sortIcon></th>
        <th pSortableColumn="AccCode">Account Code <p-sortIcon field="AccCode"></p-sortIcon></th>
        <th pSortableColumn="AccName">Account Name <p-sortIcon field="AccName"></p-sortIcon></th>
        <th pSortableColumn="Mode">Mode <p-sortIcon field="Mode"></p-sortIcon></th>
        <th pSortableColumn="ScripName">Script Name <p-sortIcon field="ScripName"></p-sortIcon></th>
        <th pSortableColumn="ISIN">ISIN No <p-sortIcon field="ISIN"></p-sortIcon></th>
        <th pSortableColumn="TotalPrice">Total Price <p-sortIcon field="TotalPrice"></p-sortIcon></th>
        <th pSortableColumn="TradeDate">Trade Date <p-sortIcon field="TradeDate"></p-sortIcon></th>
        <th pSortableColumn="TradedQuantity">Trade QTY <p-sortIcon field="TradedQuantity"></p-sortIcon></th>
        <th pSortableColumn="StrikePrice">Strike Price <p-sortIcon field="StrikePrice"></p-sortIcon></th>
        <th pSortableColumn="ExpiryDate">Expiry Date <p-sortIcon field="ExpiryDate"></p-sortIcon></th>
        <th pSortableColumn="OptionType">Option Type <p-sortIcon field="OptionType"></p-sortIcon></th>
      </tr>
    </ng-template>

    <!-- Table Body -->
    <ng-template pTemplate="body" let-product>
      <tr>
        <td>{{ product.Segment }}</td>
        <td>{{ product.AccCode }}</td>
        <td>{{ product.AccName }}</td>
        <td>{{ product.Mode }}</td>
        <td>{{ product.ScripName }}</td>
        <td>{{ product.ISIN }}</td>
        <td>{{ product.TotalPrice }}</td>
        <td>{{ product.TradeDate | date: 'yyyy-MM-dd' }}</td>
        <td>{{ product.TradedQuantity }}</td>
        <td>{{ product.StrikePrice }}</td>
        <td>{{ product.ExpiryDate | date: 'yyyy-MM-dd' }}</td>
        <td>{{ product.OptionType }}</td>
      </tr>
    </ng-template>

    <!-- Empty Message -->
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="12" class="text-center">No products found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>

</div>